<%= javascript_include_tag "avatar-prev.js" %>

<div class="container my-4">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-9 col-11 p-0">
      <div class="text-left">
        <%= form_with model: @user, url: profile_path, local: true do |f| %>
          <%= render 'shared/error_messages', object: f.object %>
          <div class="form-group avatar-panel d-flex justify-content-evenly justify-content-sm-center pb-2">
            <div class="prev-img position-relative border-right border-secondary pe-3 pe-sm-4">
              <%= image_tag @user.avatar, id: 'prev_img', class: "d-block-inline rounded-circle bg-dark-subtle", data: { avatar_url: rails_blob_path(@user.avatar, only_path: true) } if @user.avatar.attached? %>
              <div class="delete-preview operetion-bg pointer position-absolute top-0 end-0 me-2 mb-2">
                <i class="fas fa-times text-white d-flex justify-content-center align-items-center h-100 m-0"></i>
              </div>
            </div>
            <%= f.label :avatar, class: "m-0" do %>
              <div class="input-area d-flex align-items-center justify-content-center d-block-inline flex-wrap border-dashed border-2 rounded-1 border-secondary pointer ms-3 ms-sm-5">
                <div class="text-center text-secondary">
                  <i class="fas fa-camera me-1"></i>画像を
                  <br>選択する
                </div>
              </div>
              <%= f.file_field :avatar, class: "form-control", :id => 'user_avatar', accept: '.jpeg, .jpg, .png', style: "display: none;" %>
            <% end %>
          </div>
          <div class="form-group">
            <i class="fas fa-user me-1"></i>
            <%= f.label :name, class: "fw-bold" %>
            <%= f.text_field :name, class: 'form-control bg-light', placeholder: User.human_attribute_name(:name) %>
          </div>
          <div class="form-group">
            <i class="fas fa-bicycle"></i>
            <%= f.label t("users.new.my_bike"), class: "fw-bold text-break", for: "my_bike" %>
            <%= f.select :my_bike, User.my_bikes.keys, {}, class: 'form-control bg-light', id: "my_bike" %>
          </div>
          <div class="form-group">
            <i class="fas fa-envelope"></i>
            <%= f.label :bio, class: "fw-bold" %>
            <%= f.text_area :bio, class: 'form-control bg-light', placeholder: User.human_attribute_name(:bio), rows: 2 %>
          </div>
          <div class="form-group">
            <%= f.submit t("defaults.update"), class: 'btn btn-primary btn-block font-weight-bold rounded-pill mt-4' %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>